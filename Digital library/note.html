<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Notes â€“ Digital Web-Based Library</title>

    <!-- Bootstrap 5.3 + Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg: #ffffff;
            --text: #212529;
            --card-bg: #ffffff;
            --border: #dee2e6;
            --primary-start: #007bff;
            --primary-end: #00c4b4;
            --accent: #00c4b4;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --shadow: rgba(0, 123, 255, 0.12);
            --dark-bg: #0d1b2a;        /* Deep navy instead of black */
            --dark-card: #1e2a3a;
            --dark-text: #e9ecef;
        }
        [data-theme="dark"] {
            --bg: var(--dark-bg);
            --text: var(--dark-text);
            --card-bg: var(--dark-card);
            --border: #334155;
            --shadow: rgba(0, 196, 180, 0.2);
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: var(--bg);
            color: var(--text);
            transition: all 0.3s ease;
        }

        /* Navbar Gradient */
        /* .navbar {
            background: linear-gradient(135deg, var(--primary-start), var(--primary-end)) !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        .navbar-brand, .nav-link { color: #fff !important; font-weight: 500; }
        .nav-link:hover { color: #fff !important; opacity: 0.9; } */
        .navbar{background:#fff;box-shadow:0 2px 8px rgba(0,0,0,.1);position:fixed;width:100%;top:0;z-index:1000;}
        .navbar-brand{font-weight:700;color:#1e3a8a !important;display:flex;align-items:center;}
        .navbar-brand i{margin-right:10px;}
        .nav-link{color:#4b5563;transition:all .3s;padding:10px 15px;border-radius:5px;margin:0 5px;}
        .nav-link:hover,.nav-link.active{color:#fff !important;background:#3b82f6;}


        /* Cards */
        .card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 14px;
            box-shadow: 0 4px 16px var(--shadow);
            transition: all 0.3s ease;
        }
        .note-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 28px var(--shadow);
        }

        .container h1{
            margin-top: 20px;
        }

        #exportBtn{
            margin-top: 20px;
        }

        /* Form Inputs */
        .form-control, .form-select {
            border: 2px solid #ced4da;
            border-radius: 12px;
            transition: all 0.2s;
            background: var(--card-bg);
        }
        .form-control:focus, .form-select:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 0.2rem rgba(0, 196, 180, 0.25);
        }

        /* Gradient Buttons */
        .btn-gradient {
            background: linear-gradient(135deg, var(--primary-start), var(--primary-end));
            border: none;
            color: white;
            font-weight: 500;
            border-radius: 12px;
            padding: 11px 24px;
            transition: all 0.3s;
        }
        .btn-gradient:hover {
            background: linear-gradient(135deg, var(--primary-end), var(--primary-start));
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(0, 196, 180, 0.3);
        }

        /* Accent Buttons */
        .btn-accent { background: var(--accent); border: none; color: white; }
        .btn-accent:hover { background: #00a89a; }
        

        /* Word Counter */
        .word-count {
            font-size: 0.85rem;
            font-weight: 500;
        }
        .word-count.safe { color: var(--accent); }
        .word-count.danger { color: var(--danger); }

        /* Search Box */
        .search-box {
            max-width: 420px;
            border-radius: 50px;
            padding-left: 2.6rem;
            background: var(--card-bg);
            border: 2px solid #ced4da;
        }
        .search-box:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 0.2rem rgba(0, 196, 180, 0.25);
        }
        .search-icon {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
            pointer-events: none;
        }

        /* Export Button */
        #exportBtn {
            background: var(--card-bg);
            border: 2px solid var(--accent);
            color: var(--accent);
            border-radius: 50px;
            font-weight: 500;
            padding: 6px 16px;
            font-size: 0.9rem;
        }
        #exportBtn:hover {
            background: var(--accent);
            color: white;
        }

        /* Back to Top */
        .back-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 52px;
            height: 52px;
            background: linear-gradient(135deg, var(--primary-start), var(--primary-end));
            color: white;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
            transition: all 0.3s;
            font-size: 1.2rem;
        }
        .back-to-top:hover {
            transform: scale(1.12);
            box-shadow: 0 8px 24px rgba(0, 196, 180, 0.35);
        }

        /* Dark Mode Toggle */
        #themeToggle {
            background: rgba(255,255,255,0.25);
            border: 1px solid rgba(255,255,255,0.4);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #themeToggle:hover {
            background: rgba(255,255,255,0.35);
        }

        /* Footer */
        .footer {
            background: linear-gradient(135deg, #f1f3f5, #e9ecef) !important;
            color: #495057;
            border-top: 1px solid #dee2e6;
        }
        [data-theme="dark"] .footer {
            background: linear-gradient(135deg, #1e2a3a, #2d3a4d) !important;
            color: #bcc8d6;
            border-top: 1px solid #334155;
        }
        .footer a { color: var(--accent); }
        .footer a:hover { color: #007bff; }

        .footer h5{
            color: black;
        }

        .footer p{
            color: #2d3a4d;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .search-box { max-width: 100%; }
            .note-card .btn { font-size: 0.75rem; padding: 4px 8px; }
            .btn-gradient { padding: 10px 18px; font-size: 0.9rem; }
        }
    </style>
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container">
        <a class="navbar-brand" href="index.html">Digital Library</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="nav">
            <ul class="navbar-nav ms-auto align-items-center">
                <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                <li class="nav-item"><a class="nav-link" href="books.html">Books & Research</a></li>
                <li class="nav-item"><a class="nav-link" href="features.html">Features</a></li>
                <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
                <li class="nav-item"><a class="nav-link" href="faq.html">FAQ</a></li>
                <li class="nav-item"><a class="nav-link active" href="notes.html">My Notes</a></li>
                <li class="nav-item"><a class="nav-link" href="quiz.html">Take Quiz</a></li>
                <!-- <li class="nav-item ms-3">
                    <button id="themeToggle" class="btn" title="Toggle Dark Mode">
                        Moon Icon
                    </button>
                </li> -->
            </ul>
        </div>
    </div>
</nav>

<!-- MAIN CONTENT -->
<div class="container my-5">
    <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-2">
        <h1 class="mb-0 fw-bold" style="background: linear-gradient(135deg, #007bff, #00c4b4); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
            My Notes
        </h1>
        <button id="exportBtn" class="btn">
            Download Icon Export All
        </button>
    </div>

    <!-- Search -->
    <div class="mb-4 position-relative">
        <i class="fas fa-search search-icon"></i>
        <input type="text" id="searchInput" class="form-control search-box ps-5" placeholder="Search your notes..." autocomplete="off">
    </div>

    <!-- Add / Edit Form -->
    <div class="card mb-4">
        <div class="card-body">
            <form id="noteForm">
                <input type="hidden" id="noteIndex" value="-1">
                <div class="mb-3">
                    <label for="noteTitle" class="form-label">Title <small class="text-muted">(optional, max 100 chars)</small></label>
                    <input type="text" class="form-control" id="noteTitle" maxlength="100" placeholder="Quick ideaâ€¦">
                </div>
                <div class="mb-3">
                    <label for="noteBody" class="form-label">
                        Note <span class="text-danger">*</span>
                        <span class="word-count float-end" id="wordCount">0 / 100 words</span>
                    </label>
                    <textarea class="form-control" id="noteBody" rows="5" maxlength="1000" placeholder="Write your idea hereâ€¦" required></textarea>
                    <small class="text-muted d-block mt-1">Max 100 words, 1000 characters</small>
                </div>
                <button type="submit" class="btn btn-gradient">Save Note</button>
                <button type="button" class="btn btn-secondary ms-2" id="cancelEdit" style="display:none;">Cancel</button>
                <p id="noteMsg" class="mt-3" style="display:none;"></p>
            </form>
        </div>
    </div>

    <!-- Notes Grid -->
    <div id="notesList" class="row g-3"></div>
</div>

<!-- FOOTER -->
<footer class="footer text-white py-4 mt-5">
    <div class="container">
        <div class="row">
            <div class="col-md-4 mb-3"><h5>About Digital Library</h5>
                <p>Free, high-quality coding resources for 2025 and beyond.</p>
            </div>
            <div class="col-md-4 mb-3"><h5>Quick Links</h5>
                <ul class="list-unstyled">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="books.html">Books & Research</a></li>
                    <li><a href="notes.html">My Notes</a></li>
                    <li><a href="features.html">Features</a></li>
                    <li><a href="about.html">About</a></li>
                </ul>
            </div>
            <div class="col-md-4 mb-3"><h5>Stay Connected</h5>
                <div class="social-links">
                    <a href="#" class="me-3">Twitter Icon</a>
                    <a href="#" class="me-3">LinkedIn Icon</a>
                    <a href="#" class="me-3">GitHub Icon</a>
                </div>
            </div>
        </div>
        <div class="text-center mt-3">
            <p>Â© 2025 Digital Web-Based Library. All rights reserved.</p>
        </div>
    </div>
</footer>

<a href="#" class="back-to-top">Up Arrow</a>

<!-- SCRIPTS -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

<script>
/* ==============================================================
   MY NOTES â€“ NO BLACK, BRIGHT & BRANDED
   ============================================================== */
const MAX_WORDS = 100;
const MAX_CHARS = 1000;
let notes = JSON.parse(localStorage.getItem('userNotes')) || [];
let autoSaveTimer = null;

// === Theme Toggle ===
// const themeToggle = document.getElementById('themeToggle');
// const currentTheme = localStorage.getItem('theme') || 'light';
// document.documentElement.setAttribute('data-theme', currentTheme);
// themeToggle.innerHTML = currentTheme === 'dark' ? 'Sun Icon' : 'Moon Icon';

// themeToggle.addEventListener('click', () => {
//     const newTheme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
//     document.documentElement.setAttribute('data-theme', newTheme);
//     localStorage.setItem('theme', newTheme);
//     themeToggle.innerHTML = newTheme === 'dark' ? 'Sun Icon' : 'Moon Icon';
// });

// === Sanitize ===
function sanitize(str) {
    const div = document.createElement('div');
    div.textContent = str || '';
    return div.innerHTML;
}

// === Word Counter ===
function updateWordCount() {
    const text = document.getElementById('noteBody').value;
    const words = text.trim().split(/\s+/).filter(w => w.length > 0).length;
    const countEl = document.getElementById('wordCount');
    countEl.textContent = `${words} / ${MAX_WORDS} words`;
    countEl.className = `word-count float-end ${words > MAX_WORDS ? 'danger' : 'safe'}`;
}
document.getElementById('noteBody').addEventListener('input', updateWordCount);

// === Auto-save Draft ===
function startAutoSave() {
    if (autoSaveTimer) clearTimeout(autoSaveTimer);
    autoSaveTimer = setTimeout(() => {
        const draft = {
            title: document.getElementById('noteTitle').value,
            body: document.getElementById('noteBody').value,
            timestamp: Date.now()
        };
        localStorage.setItem('noteDraft', JSON.stringify(draft));
    }, 2000);
}
document.getElementById('noteTitle').addEventListener('input', startAutoSave);
document.getElementById('noteBody').addEventListener('input', startAutoSave);

// Load draft
window.addEventListener('load', () => {
    const draft = JSON.parse(localStorage.getItem('noteDraft'));
    if (draft && draft.body) {
        document.getElementById('noteTitle').value = draft.title || '';
        document.getElementById('noteBody').value = draft.body;
        updateWordCount();
        showMsg('Draft restored!', 'info');
    }
});

// === Render Notes ===
function renderNotes(filter = '') {
    const container = document.getElementById('notesList');
    container.innerHTML = '';

    const filtered = notes.filter(n => 
        n.title.toLowerCase().includes(filter) || 
        n.body.toLowerCase().includes(filter)
    );

    if (filtered.length === 0) {
        container.innerHTML = `<div class="col-12"><p class="text-muted text-center">
            ${filter ? 'No notes match your search.' : 'No notes yet. Add one above.'}
        </p></div>`;
        return;
    }

    filtered.forEach((n, idx) => {
        const realIdx = notes.indexOf(n);
        const card = document.createElement('div');
        card.className = 'col-md-6 col-lg-4';
        card.innerHTML = `
            <div class="card note-card h-100">
                <div class="card-body d-flex flex-column">
                    <h6 class="card-title" style="color: var(--accent);">${sanitize(n.title || '(no title)')}</h6>
                    <p class="card-text flex-grow-1">${sanitize(n.body).replace(/\n/g, '<br>')}</p>
                    <small class="text-muted mb-2">${new Date(n.savedAt).toLocaleString()}</small>
                    <div class="mt-auto">
                        <button class="btn btn-sm btn-warning me-1" onclick="editNote(${realIdx})">
                            Edit Icon Edit
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteNote(${realIdx})">
                            Trash Icon Delete
                        </button>
                    </div>
                </div>
            </div>`;
        container.appendChild(card);
    });
}

// === Save / Update ===
document.getElementById('noteForm').addEventListener('submit', function (e) {
    e.preventDefault();
    const idx = parseInt(document.getElementById('noteIndex').value, 10);
    const title = document.getElementById('noteTitle').value.trim();
    const body = document.getElementById('noteBody').value.trim();

    const words = body.split(/\s+/).filter(w => w.length > 0).length;
    if (words > MAX_WORDS) {
        showMsg(`Too many words! Max ${MAX_WORDS}.`, 'danger');
        return;
    }
    if (body.length > MAX_CHARS) {
        showMsg(`Too long! Max ${MAX_CHARS} characters.`, 'danger');
        return;
    }
    if (!body) {
        showMsg('Please write a note.', 'danger');
        return;
    }

    const note = { title, body, savedAt: Date.now() };

    if (idx >= 0) {
        notes[idx] = note;
        showMsg('Note updated!', 'success');
    } else {
        notes.push(note);
        showMsg('Note saved!', 'success');
    }

    localStorage.setItem('userNotes', JSON.stringify(notes));
    localStorage.removeItem('noteDraft');
    this.reset();
    document.getElementById('noteIndex').value = '-1';
    document.getElementById('cancelEdit').style.display = 'none';
    updateWordCount();
    renderNotes(document.getElementById('searchInput').value.toLowerCase());
});

// === Edit, Cancel, Delete, Search, Export ===
window.editNote = function (idx) {
    const n = notes[idx];
    document.getElementById('noteTitle').value = n.title || '';
    document.getElementById('noteBody').value = n.body;
    document.getElementById('noteIndex').value = idx;
    document.getElementById('cancelEdit').style.display = 'inline-block';
    updateWordCount();
    document.querySelector('.card-body form').scrollIntoView({ behavior: 'smooth' });
};

document.getElementById('cancelEdit').addEventListener('click', () => {
    document.getElementById('noteForm').reset();
    document.getElementById('noteIndex').value = '-1';
    document.getElementById('cancelEdit').style.display = 'none';
    updateWordCount();
    localStorage.removeItem('noteDraft');
});

window.deleteNote = function (idx) {
    if (confirm('Delete this note permanently?')) {
        notes.splice(idx, 1);
        localStorage.setItem('userNotes', JSON.stringify(notes));
        renderNotes(document.getElementById('searchInput').value.toLowerCase());
    }
};

document.getElementById('searchInput').addEventListener('input', function () {
    renderNotes(this.value.toLowerCase());
});

document.getElementById('exportBtn').addEventListener('click', () => {
    if (notes.length === 0) {
        showMsg('No notes to export.', 'warning');
        return;
    }
    let text = '=== MY NOTES ===\n\n';
    notes.forEach((n, i) => {
        text += `NOTE ${i+1}\n`;
        if (n.title) text += `Title: ${n.title}\n`;
        text += `${n.body}\n`;
        text += `Saved: ${new Date(n.savedAt).toLocaleString()}\n\n`;
    });
    const blob = new Blob([text], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `my-notes-${new Date().toISOString().slice(0,10)}.txt`;
    a.click();
    URL.revokeObjectURL(url);
    showMsg('Notes exported!', 'success');
});

function showMsg(text, type) {
    const el = document.getElementById('noteMsg');
    el.textContent = text;
    el.className = `mt-3 text-${type} fw-semibold`;
    el.style.display = 'block';
    setTimeout(() => el.style.display = 'none', 3000);
}

window.addEventListener('scroll', () => {
    document.querySelector('.back-to-top').style.display =
        window.scrollY > 300 ? 'flex' : 'none';
});

// Init
renderNotes();
updateWordCount();
</script>
</body>
</html>